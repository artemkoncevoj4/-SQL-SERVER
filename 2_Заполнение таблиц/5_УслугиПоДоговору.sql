use Интернет_провайдер;

-- Клиент 1: Иван Петров Сергеевич (активный договор с Ростелеком)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Игровой 300'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Иван' AND Фамилия='Петров');

-- Клиент 2: Мария Иванова Александровна (активный договор с Билайн)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Всё включено 150'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Мария' AND Фамилия='Иванова');

-- Клиент 3: Алексей Смирнов Дмитриевич (активный договор с МТС)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'МТС 120'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Алексей' AND Фамилия='Смирнов');

-- Клиент 4: Екатерина Кузнецова Владимировна (активный договор с Дом.ru)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Домашний 130'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Екатерина' AND Фамилия='Кузнецова');

-- Клиент 5: Дмитрий Попов Игоревич (активный договор с ТТК)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'ТТК 110'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Дмитрий' AND Фамилия='Попов');

-- Клиент 6: Ольга Лебедева Николаевна (активный договор с Ростелеком)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Домашний 100'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Ольга' AND Фамилия='Лебедева');

-- Клиент 7: Сергей Новиков Петрович (активный договор с Билайн)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Игровая зона 400'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Сергей' AND Фамилия='Новиков');

-- Клиент 8: Анна Морозова Викторовна (активный договор с МТС)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Семейный кинозал 280'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Анна' AND Фамилия='Морозова');

-- Клиент 9: Андрей Волков Олегович (активный договор с Дом.ru)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Игровой 320'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Андрей' AND Фамилия='Волков');

-- Клиент 10: Наталья Соловьева Сергеевна (активный договор с ТТК)
INSERT INTO [Услуги по договору] (
    [id договора],
    [id тарифа],
    [Дата начала],
    [Дата окончания],
    [Активна]
)
SELECT
    d.[id договора],
    t.[id тарифа],
    d.[Дата заключения договора] as [Дата начала],
    DATEADD(MONTH, 1, d.[Дата заключения договора]) as [Дата окончания],
    1 as [Активна]
FROM [Договоры] d
INNER JOIN [Тарифные планы] t ON d.[id провайдера] = t.[id провайдера]
WHERE d.[Статус активности] = 'Активен'
AND t.[Название тарифа] = 'Геймер 300'
AND d.[id клиента] = (SELECT id FROM Клиенты WHERE Имя='Наталья' AND Фамилия='Соловьева');
GO